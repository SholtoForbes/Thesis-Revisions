% 2_literature-review.tex

\cleardoublepage
\chapter{Literature review}\label{chapter:literature-review}

 %\textcolor{red}{XXX Sort out airbreathing vs partially airbreathing}

% \textcolor{red}{XXX sort out SPARTAN nomenclature... hypersonix website uses SPARTAN as whole system I think}

  \textcolor{red}{
This work aims to expand our knowledge on the operation of partially air-breathing multi-stage launch systems, by developing a trajectory for a rocket-scramjet-rocket small satellite launch system based on The University of Queensland's SPARTAN launch system. The trajectory development involves the calculation of the ascent-to-orbit of all three stages as well as the full return of the second stage, using the Pseudodospectral Method, a state of the art method of optimal control, to find the maximum payload-to-orbit trajectory profile. This optimal trajectory profile is then investigated with performance variations in the launch system, and analysed using energy methods to give insights into the trade-offs between the rocket and airbreathing stages that are unique to this type of launch system. This manner of optimal trajectory analysis allows for generalities to be made about the nature of the trajectory shape, and for understanding of the variations in the optimal trajectory with changes in the performance of the launch system to be developed.}

\textcolor{red}{
This section covers the literature available in the areas that are key to developing and analysing the trajectory for a rocket-scramjet-rocket launch system. Firstly, a background of the process of designing and flying access to space systems is given, to supply the reader with a context for the current work in the process of partially-airbreathing launch system development. 
A review of the previously developed designs of partially-airbreathing launch systems is conducted, along with an analysis of the trajectories that are able to offer valuable insights into the operations of reusable airbreathing launch systems. Of particular interest are the trajectories of partially-airbreathing launch systems that have previously been optimised to maximise a performance target, that give insights into the trajectory features that arise from the unique nature of partially-airbreathing launch systems. 
}
  
  
  
  
  \nomenclature[a]{REST}{Rectangular-to-Elliptical Shape Transition}
  
  

   
   
   
  
  \textcolor{red}{
  \section{The Launch System Design Process}
}

The design of a launch system is a complex process, that involves overcoming many engineering challenges. A launch system must go through a multi-faceted design process, to take it from a definition of requirements to a physically realised and viable product. Figure \ref{fig:DesignFlow} illustrates the general design process flow for a launch system as defined by NASA\cite{Blair2001}, in which the design stages involve a repeated iterative process between the overall launch system design and compartmentalised design tasks. This compartmentalisation takes place firstly by separating the
launch system into its hardware and software subsystems, and then into general design functions that define the specifications of the subsystem design. These design functions include;
\begin{figure}[ht]
	\centering
	\includegraphics[width=0.7\linewidth]{figures/2_literature-review/DesignFlow}
	\caption{The general design process flow for a launch vehicle, adapted from \cite{Blair2001}}
	\label{fig:DesignFlow}
\end{figure}
\begin{itemize}
	\setlength\itemsep{.2em}
\item aerodynamics;
\item trajectory, guidance and navigation;
\item control;
\item structures;
\item thermal;
\item propulsion;
\item avionics;
\item materials;
\item and manufacturing,
\end{itemize}
among others\cite{Blair2001}. These design functions are further compartmentalised into discipline functions, which represent areas of specific speciality and expertise pertinent to the design functions. This process of compartmentalisation allows the effort associated with launch system design to be broken down into manageable amounts, and enabled the efficient utilisation of discipline and industrial specialities. 
The design process is a continuous effort to compartmentalise from the system to the subsystem, design function, and discipline function levels, and then to reintegrate and synthesise the work undertaken in order to converge on a design that is able to satisfy the overarching mission requirements\cite{Blair2001}.


 	Airbreathing launch systems are still in the conceptual design phase, with top level objectives and design concepts being defined. Many of the subsystems and technologies necessary to achieve airbreathing space access are in development at an academic level, and advances are necessary in multiple fields before the flight of an airbreathing launch vehicle becomes a reality. This work aims to contribute to the ongoing design of airbreathing space access vehicles by assessing the trajectory of a rocket-scramjet-rocket multi-stage launch system, contributing to the design and discipline function effort if the general mission requirement in the wider context is viewed as the development of an airbreathing space access vehicle.
 



  \textcolor{red}{
  	\subsection{Trajectory Modelling}
  }

\textcolor{red}{XXX Citations needed}




	The determination and simulation of a launch system's trajectory is an integral part of the design process. The need to exit the atmosphere as efficiently as possible must be balanced against the limitations of the launch vehicle design, so that the optimal balance is found between efficiency in the design of a launch system, and the trajectory that it takes to orbit. 
	 The trajectory and design of a launch system are heavily interconnected, with the vehicle design informing the limitations and requirements imposed on the trajectory profile, and vice versa. 
	 The mass, engine performance and aerodynamic characteristics of a launch vehicle must be determined with careful consideration of the trajectory, particularly because the flight of a launch system involves vehicles flying at very high speeds and being subject to extreme aerodynamic, structural and heating loads. In the early design phases the trajectory may be very simplified, giving only a general indication of the performance of the launch system. However, even a simplified representation may be of significant use, the most relevant example of which is the Tsiolkovsky Rocket Equation, which is able to provide a first principles sizing of a rocket, assuming no external forces are acting upon it. In later design stages, more accurate trajectory models are required, including trajectories simulated to maximise the key performance metric of the launch system. These initial flight paths are then used to guide the control laws and mechanisms of the launch system.

For an airbreathing launch system, the design of a trajectory during the early design phases is particularly important. Airbreathing launch systems are typically designed using a combination of rocket and airbreathing engines, sometimes separated into multiple stages. These engines have very different requirements for operation, with rocket engines generally performing marginally better in a low density environment, at high altitudes, while airbreathing engines require relatively high density air, and require sustained atmospheric flight for operation. Figure \ref{fig:FlightCorridor} shows an example flight corridor for a partially-airbreathing launch vehicle, illustrating the upper limits of dynamic pressure at which the structural limits of the launch vehicle are met, and the lower limit of dynamic pressure at which the airbreathing engines are no longer capable of operation. 
\begin{figure}[ht]
\centering
\includegraphics[width=0.7\linewidth]{figures/2_literature-review/FlightCorridor}
\caption{An example airbreathing flight corridor of a partially-airbreathing launch vehicle.}
\label{fig:FlightCorridor}
\end{figure}
This brings unique complications, as sustained flight in-atmosphere requires a high lift coefficient and results in high structural and thermal loading over long periods, that must be considered during trajectory analysis. In addition, there are a number of design factors that must be considered during trajectory design including;
\begin{itemize}
	\item the requirement for the airbreathing stages to fly in-atmosphere;
	\item the variable efficiency of the airbreathing engines;
	\item the relative efficiency of the different types of engines within the system;
	\item the aerodynamic performance of each vehicle or engine-mode of the system;
	\item and the structural limitations of the system.
\end{itemize}
These factors cause trade-offs between the stages of the launch system, and limit the operational regime of the launch system.
 Developing the trajectory for a partially-airbreathing launch system requires understanding the trade-offs and limitations that are specific to the type of launch system being analysed.


As well as complex trade-offs during ascent, the reduced fuel usage of airbreathing engines allows for the inclusion of systems that enable fly-back and landing of some or all of the launch system in a similar manner to a conventional aircraft, potentially offering multi-launch re-use with increased launch flexibility and decreased costs\cite{Preller2017b}. The return portion of the trajectory must be considered in all trajectory analysis and concurrent design for reusable launch systems. This brings additional considerations to the vehicle and trajectory design, because the vehicle must be designed to withstand the conditions of return as well as launch, and must be physically able to return and land at a suitable location. The trajectory analysis of a reusable vehicle is particularly important, as the viability of returning the vehicle to a suitable landing location must be determined, and the impact of the return trajectory on the launch flight profile must be established. 
	This study aims to understand the features of the optimal trajectory of a rocket-scramjet-rocket multi-stage launch system, which may be considerably different to other configurations of partially-airbreathing launchers. 


    \textcolor{red}{
  \section{Hypersonic Airbreathing Launch Systems and Trajectories}\label{sec:AscentTrajectories}
}
  %\textcolor{red}{XXX I should clearly define the fidelity to which each launch is modelled.}
 
  %\textcolor{red}{XXX I should distinguish between launch systems using turbojets (ie virgin) and hypersonic launchers}
  %\textcolor{red}{XXX I should try to keep this positive, ie. this is how the results from each study can help us}
  
%\textcolor{red}{XXX from reviewer: "Significantly expanding Section 2.4 include a more thorough review of air-breathing access to space systems with a particular focus on underlying technologies and their respective strengths and limitations." "Expanding Section 2.5 and 2.6 (on launchers and trajectories) with a focus on critically reviewing the range of methodologies/ constraints/ key assumptions adopted by various authors in developing trajectories for single and multiple-stage to orbit systems. Specific emphasis should be placed on highlighting the shortcomings, methodologies, cost functions, and constraints used in these approaches and how the present work seeks to address them."}
    
Airbreathing access-to-space systems have been investigated in various forms including single-stage, two-stage, and three-stage designs. 
Of these design forms, single-stage and two-stage designs are by far the most common, with very few three-stage designs having been considered to date. This is partly due to the fact that nearly all of the partially-airbreathing launch systems that have been designed are large launchers, designed to launch payloads on the order of thousands of kilograms to orbit. In large launchers, the additional structural mass that results from the addition of engines or subsystems can be mitigated more effectively than for small launcher form factors, allowing for multiple engine types within a single stage. 
For small satellite launchers, the mass penalties become more significant, necessitating the division of the launcher into separate stages. 
For dedicated small satellite launch, which has become economically feasible only in recent years, a three-stage rocket-scramjet-rocket launcher system has been suggested as the most practical form factor for a small, airbreathing launcher. This is the form factor being investigated in this work. 

 



This section investigates the designs of all forms of partially-airbreathing launch systems that have been developed, along with their trajectories. The manner in which the design and number of stages of the launch systems influences their trajectories is studied. This analysis allows for some key features of airbreathing launch system trajectories to be identified, that may assist in defining the optimal trajectory for a rocket-scramjet-rocket multi-stage launch system.
  
 
  
  
  
  
  %\textcolor{red}{XXX Combine this with airbreathing access to space systems section. Make each section a more in depth review of single or multi stage launchers, and include their trajectories with them. I should strongly make the point that a well comprehensive study and optimisation of the mission of a multi stage launch system is missing. - note after, I need to think about whether it would be best to combine or keep these separate.}
  
  %\textcolor{red}{I should note how much of each launch system is reusable, and also whether there is a jettisoned heat shield?}
  
  %\textcolor{red}{make sure to make it clear that a three-stage / small system has not been analysed before, and that high accuracy and robust optimisation is required for a detailed trajectory analysis}
  
  %\textcolor{red}{XXX Point out the propulsion systems of the different launchers, and how scramjet powered is different.}
  
  %\textcolor{red}{XXX Be very specific about how they pulled up, why and to where}
  
  %\textcolor{red}{XXX I should be very specific that I'm looking at a small, vertically launched, three stage system.. look at all ways that my analysis is different including whether banking during ascent is allowed (dont think banking is allowed in tsuchiya and mori during ascent) and what fidelity optimisation is used, also what engine is used (tsuchiya and mori are using a pre-cooled turbojet..)}
  
  %\textcolor{red}{XXX} more papers to include:
  %https://www.jstage.jst.go.jp/article/tjsass/60/5/60_T-15-71/_pdf/-char/ja (NOTE: 2DOF)
  
  %\textcolor{red}{XXX I should have a paragraph detailing why looking at variation studies is important, and compare to MDO (how it is different)}
  
  %\textcolor{red}{XXX I need to look at the designs of the launch vehicles, and how they relate to their trajectories, particularly vertical vs horizontal launch}
  
  
 
  
  
 \textcolor{red}{
  \subsection{Single Stage Airbreathing Launch Systems}
}

\afterpage{
	\begin{landscape}% Landscape page
%\begin{table}[ht]
\begin{xltabular}{\linewidth}{|X|X|X|}
\hline \small  \textbf{Launcher} &\small \textbf{Design} &\small \textbf{Trajectory}\\ 
\hline \small \textbf{X-30} (NASP)\cite{NASP} \newline \newline Conceived as a technology demonstrator for the NASP program, the X-30 would have been the first airbreathing launch system to be operationally demonstrated, but its program was cancelled prematurely. Many important aspects of the X-30 have not been made public\cite{NASP} and so details on this vehicle are incomplete.   
&\small
\raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/X30"}} 

$\cdot$Designs studied with weights 'less than 200000lbs and greater than 300000lbs'\cite{NASP} (90718.5 - 136077.7kg).

$\cdot$Powered by scramjets with reusable rocket engines or RBCC engines.

&\small
\raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/X30Traj"}} 

$\cdot$ Horizontal launch.
\\
\hline\small \textbf{Langley Accelerator} (NASP)\cite{WCC,Powell1991,Lu1993} 
\newline  \newline Developed as a standardised vehicle for single-stage-to-orbit airbreathing launcher studies, the Langley Accelerator was not intended to be an operational concept. The version developed by Powell et al.\cite{Powell1991} is presented here. 
&
\small
\raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/Powell Vehicle"}} 

$\cdot$Nominally 136079kg weight, 61m length.

$\cdot$Fully airbreathing in-atmosphere, rockets for circularisation.

$\cdot$Forward canards are deployed at subsonic speeds.

&
\small
\raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/Powell Trajectory"}} 

$\cdot$Horizontally launched. 

$\cdot$Maximum dynamic pressure reached as rapidly as possible. 

$\cdot$A pull-up is performed under the power of the scramjet engines. 

$\cdot$Coast phase after scramjet shutdown until circularisation by rocket engines.

 \\ 
 \hline \small \textbf{HOTOL}\cite{Aberleen}\newline\newline
 The British HOTOL concept was a single-stage-to-orbit spaceplane developed initially as a proof-of-concept study in 1982, but later courted to the ESA as a major project and refused. Funding was withdrawn in 1982 before development could commence. 
 & \small
 \raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/HOTOL"}}
 $\cdot$7-10t to payload to orbit.
 
 $\cdot$Length of 62m.
 
 $\cdot$Powered by four Swallow engines, operating in airbreathing mode until 26km altitude, and rocket mode thereafter.
 & \small
 $\cdot$No detailed trajectory information is readily available. 
 \\
\hline \small\textbf{ABLV-GT} (Hyper-X)\cite{Bradford2000, HyperX} 
\newline \newline 
The ABLV-GT was developed by Georgia Tech Space Systems Design Lab as an extension of the ABLV (airbreathing launch vehicle) design study performed by NASA, aiming to develop a conceptual design for a realistic launch vehicle. This vehicle has strong links to the Next Generation Launch Technology Program, a successor to the NASP program, which produced the X-43 test vehicle, the first demonstrator of scramjet operation in free-flight.
&
\small
\raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/HyperX"}}

$\cdot$X-43A shown as a representative vehicle shape.

$\cdot$13520000lbs mass and 190.5ft length.

$\cdot$Powered by turboramjet \& RBCC engines.

&
\small
\raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/ABLV-GTTraj"}}

$\cdot$Horizontal takeoff. 

$\cdot$Maximum dynamic pressure flight during majority of ram/scramjet operation.

$\cdot$Pull-up upder rocket-augmented scramjet power. 
\\ 
\hline\small \textbf{GTX} (Trailblazer)\cite{Roche2000,Trefny1999} 
\newline \newline 
The GTX (formerly Trailblazer) was another offshoot of the ABLV program.
&
\small \raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/GTX"}} 

$\cdot$1252617lbs total mass, 263.5ft length. 

$\cdot$25000lbs payload.

$\cdot$Ramjet-scramjet-rocket propulsion. 
 
&
\small \raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/GTXTraj"}}

$\cdot$Vertical takeoff. 

$\cdot$Flight at maximum dynamic pressure of 2000psfa (95.76kPa). 

$\cdot$Pull-up occurs under scramjet power, when the maximum Mach limit of the scramjet is reached. 

$\cdot$Rocket power is used to accelerate to orbit. 
 \\
\hline \small\textbf{Lazarus}\cite{Young2006} \newline \newline 
The Lazarus concept was developed at the Georgia Institute of Technology Space Systems Design Lab, as an SSTO concept for medium size payload launch, with a secondary purpose of use as a global strike platform. 

&\small \raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/Lazarus"}}  

$\cdot$180000lbs (81646.6kg) gross weight, 102.8ft (31.3m) length. 

$\cdot$5000lbs (2268.0kg) Payload.

$\cdot$RBCC engines with high energy density material fuel. 

$\cdot$A sled is used for takeoff, that provides fuel to the RBCC engines. 

&\small \raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/LazarusTraj"}}

$\cdot$Horizontal takeoff using sled.

$\cdot$Maximum dynamic pressure flight during airbreathing operation at 1800psf (86.2kPa).

$\cdot$At Mach 10 a pull-up is initiated using combined scramjet-rocket propulsion. 

$\cdot$At the minimum operable conditions of the scramjet engines, the rocket takes over to accelerate to orbit. 

$\cdot$Return trajectory is not considered. \\

\hline \small\textbf{Hyperion}\cite{Hyperion}\newline \newline 
The Hyperion was developed by Georgia Tech Space Systems Design Lab, as an assessment of the 'Vision Vehicle' design class, solicited by NASA as part of the Advanced Reusable Technologies Program. Hyperion was conceptualised to assess whether RBCC propulsion and other advanced technologies can significantly reduce the cost of space access. 
&\small \raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/Hyperion"}}  

$\cdot$800700lbs (363191.4kg) gross weight, 179ft (54.6m) length. 

$\cdot$20000lbs (9071.8kg) of payload to LEO. 

$\cdot$Powered by 5 RBCC engines, with return flight suplemented by low-thrust H2 ducted fans. 

&\small \raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/HyperionTraj"}} 

$\cdot$Horizontal takeoff.

$\cdot$Flight at maximum dynamic pressure of 2000psf (95.76kPa) during airbreathing operation. 

$\cdot$Pull-up during scramjet operation, with transition to rocket mode during pull-up. 

$\cdot$No Return trajectory considered.

\\
\hline \small\textbf{Argus}\cite{Argus} \newline\newline
The Hyperion was developed by Georgia Tech Space Systems Design Lab, in support of NASA's Highly Reusable Space Transportation study. The Argus was a conceptual design intended to be investigated and compared to other classes of launchers to determine cost effective long term solutions to space access.  
&\small
\raisebox{-\totalheight}{\includegraphics[width=0.5\linewidth]{"figures/2_literature-review/Argus"}}

$\cdot$597250lbs (270908.0kg) gross takeoff mass, 171ft (52.1m) length. 

$\cdot$20000lbs (9071.8kg) payload.

$\cdot$Initially accelerated along a maglifter track. Afterwards powered by two RBCC ejector-ramjet engines, with OMS thrusters used for circularisation and manoeuvring on-orbit. 

&\small
$\cdot$Horizontal launch on maglifter track. 

$\cdot$After launch, accelerated using ejector ramjet so that maximum dynamic pressure of 1500psf (71.8kPa) is reached at transition to fan-ramjet mode. 

$\cdot$At Mach 6, transition to rocket mode occurs for acceleration to parking orbit.\\ 

\hline 
\end{xltabular} 
		%\end{table}
	\end{landscape}
}

A single stage launch system design aims to achieve space launch with only one vehicle, and generally no separation of mass until payload deployment. Table XXX summarises the recent single-stage-to-orbit airbreathing launchers that have been developed as detailed designs, along with their key design and trajectory features. 

All of the SSTO airbreathing launchers that have been investigated are designed for medium-to-large payload launch, and are heavy vehicles, with design profiles incorporating many aircraft-like features such as wings, tails and aerodynamic control surfaces. 
SSTO vehicles are generally powered by rocket-based combined cycle (RBCC) engines which are capable of operating in various airbreathing or air-assisted rocket modes. The RBCC engines are sometimes augmented by turbojet engines for efficient power during launch or return flight. 
Most SSTO airbreathing systems are designed to be horizontally launched, under turbojet or rocket-assisted power. The exception to this is the GTX, which launches vertically under rocket power. 

All of the SSTO airbreathing launch vehicles that have been studied are designed to be fully reusable. Being fully reusable is the primary attraction of the SSTO spaceplane, and indeed is likely to be the only way in which a system of this type is able to be financially viable. 
The single-stage form factor is convenient for reusability and return trajectories, as the additional structural and subsystem complexity necessary to facilitate return is mitigated by having only one large vehicle.   

All of the SSTO vehicles examined vehicles follow a constant dynamic pressure trajectory during the majority of airbreathing hypersonic flight, with most vehicles performing a pull-up manoeuvre during airbreathing operation, before or during the transition to rocket-power. 

The reason that these constant dynamic pressures are advantageous for an airbreathing accelerator is due to the trade-off between structural loading and engine performance\cite{Olds1998}. As dynamic pressure increases so does the structural loading on the vehicle, however the performance of a ramjet or scramjet engine is directly reliant on dynamic pressure\cite{Olds1998}. A constant dynamic pressure trajectory is viewed as being an acceptable compromise between these two factors. 
Although a constant dynamic pressure trajectory is likely to produce high efficiency flight for the high speed airbreathing portion of an ascent trajectory, there are a variety of factors that must be considered in designing the trajectory of a launch system. 
For example, a constant dynamic pressure flight may produce suboptimal conditions for the switch from airbreathing engines to rocket power for exoatmospheric flight. 
It may be more optimal overall for the vehicle to fly at less than maximum dynamic pressure for a time during airbreathing engine operation, allowing the trajectory angle and altitude to be raised before the rocket engines are powered-on, increasing the efficiency of the rocket engines and reducing the dynamic pressure experienced by the rocket stage\cite{Tsuchiya2005,Wilhite1991,Mehta2001}.
This trajectory shape trades off the performance of the airbreathing engines for altitude, and has been shown to be the optimal trajectory throughout the studies of the vehicles above\cite{Powell1991,Trefny1999,Roche2000,Pescetelli2012,Young2006,Bradford2000}, as well as for generic trajectory optimisation studies that do not develop a detailed vehicle design\cite{Pescetelli2012,Mooij,Lu1993}.
A pull-up was found to be optimal for vehicles where the rocket engines are not ignited until circularization altitude\cite{Powell1991,Lu1993}, vehicles where the rocket engine is ignited immediately after airbreathing engine cut-off\cite{Trefny1999,Roche2000,Pescetelli2012} as well as for vehicles which operate in combined scramjet-rocket mode\cite{Young2006,Bradford2000}.
For SSTO vehicles a pull-up manoeuvre is a simple trade-off between the altitude at airbreathing engine cut-off and the velocity achievable at cut-off. Due to the entire vehicle being lifted into orbit, this becomes a relatively simple problem of engine efficiency. The airbreathing engine is used for its high efficiency, until the dynamic pressure drops below the operable limit of the airbreathing engine, or until the thrust provided by the airbreathing engine is significantly counteracted by the effects of drag and gravity. 

  	
  	
  \textcolor{red}{
  \subsection{Two-Stage Launch Systems}
}

\afterpage{
\begin{landscape}
\begin{xltabular}{\linewidth}{|X|X|X|}
	\hline \small  \textbf{Launcher} &\small \textbf{Design} &\small \textbf{Trajectory}\\ 
	\hline \small 
	\textbf{LaRC Turboramjet}\cite{Wilhite1991}\newline\newline
	The LaRC boosters were developed by Wilhite et al.\cite{Wilhite1991} in order to test the effects of staging Mach number on a two-stage system. These boosters were studied as part of the NASP program, and were intended only to be used as a representative vehicle for research purposes.  
	\textcolor{red}{XXX MDO?}
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/WilHite Booster Vehicle"}}
	
	$\cdot$Nominal gross takeoff weight of approximately 360klb (160Mg), although this varies with staging Mach number. 
	
	$\cdot$10000lbs (4535.9kg) of payload to LEO. 
	
	$\cdot$First stage propulsion is rocket-turboramjet, second stage propulsion is rocket. 
	
	
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/WilHite Booster Trajectory"}}
	
	$\cdot$Horizontal launch.
	
	$\cdot$Trajectory constrained to maximum dynamic pressure of 1000psf (47.9kPa) until the staging Mach number of 5,6 or 7 is reached. 
	
	$\cdot$Pull-up occurs at nominal staging Mach number under ramjet power, to reach the prescribed staging dynamic pressure of 300psf (14.4kPa). Pull-up occurs at a 2g constrained rate. 
	
	$\cdot$The orbiter trajectory is undefined.
	
	$\cdot$Booster return is achieved through an unpowered turn and deceleration, followed by a turbojet powered cruiseback. 
	\\
	
	
	\hline \small 
	\textbf{JAXA TSTO Spaceplane}\cite{Tsuchiya2005}\newline\newline
	Tsuchiya and Mori\cite{Tsuchiya2005} developed two conceptual spaceplane designs as part of a JAXA initiative to develop an SSTO airbreathing spaceplane, with TSTO launchers as an interim phase. These spaceplane designs were developed using an MDO analysis. 
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/Tsuchiya Vehicles"}}
	
	$\cdot$Fully-reusable. 
	
	$\cdot$The two boosters developed have different propulsion systems, fully airbreathing using a precooled turbojet, and turbojet/rocket.

	 $\cdot$When launching a 4Mg payload the fully-airbreathing booster weighs 216.38Mg and is 89.75m long, and the orbiter weighs 170.07Mg and is 41.45m long.
	 
	 $\cdot$When launching a 4Mg payload the airbreathing/rocket booster weighs 240.6ton and is 76.43m long, and the orbiter weighs 113.03ton and is 33.37m long.
	
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/Tsuchiya"}}
	
	$\cdot$Horizontal takeoff. 
	
	$\cdot$Both boosters reach maximum dynamic pressure of 50kPa rapidly, after a brief hold of acceleration during the transonic regime. 
	
	$\cdot$Both boosters pull-up to 15kPa dynamic pressure before separation, the maximum dynamic pressure limit of the orbiter. The airbreathing/rocket booster uses rocket power for this pull-up. 
	
	$\cdot$The boosters return to the initial launch site, initially with high bank and angle of attack, and then with angle of attack set to the angle of attack that maximises lift-to-drag. The airbreathing engines are ignited for 'several tens of seconds' to assist the return. 
	
	\\
	\hline \small 
	\textbf{NASA Ames TSTO Spaceplane}\cite{Mehta2001}\newline\newline
	A TSTO spaceplane was conceptualised by Mehta and Bowles\cite{Mehta2001}, based on a '93 design for the NASP program. This concept was designed to be economically viable launcher, with built-in growth potential. 
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=0.48\linewidth]{"figures/2_literature-review/Mehta Vehicle"}}
	\raisebox{-\totalheight}{\includegraphics[width=0.48\linewidth]{"figures/2_literature-review/Mehta Vehicle2"}}
	
	$\cdot$25000lbs (11339.8kg) of payload.
	
	$\cdot$Booster propulsion system is tubojet/ramjet/scramjet while orbiter has standard LOX/H2 rocket propulsion. 
	
	$\cdot$Booster mass is 602300lbs (273198kg) with a length of 224ft (68.3m), and orbiter mass is 199301lbs (90401kg) with a length of 64.5ft (19.7m).
	
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/Mehta Trajectory"}}
	
	$\cdot$Horizontal launch.
	
	$\cdot$Acceleration before the hypersonic regime is achieved steadily, with an increase in altitude at the transsonic 'pinch point' to reduce dynamic pressure. 
	
	$\cdot$During the hypersonic regime, a constant dynamic pressure of 2100lb/ft2 (100.5kPa) until Mach 10.
	
	$\cdot$At Mach 10, a 2g pull-up is initiated, to lower the dynamic pressure to 300lb/ft2 (14.4kPa) for separation, and to improve the flight path angle at separation. The scramjet engines are cut off at the start of this pull-up.  
	
	$\cdot$The booster flies to orbit under rocket power. 
	
	$\cdot$The booster initiates a turn, and cruises back under turbojet power. 
	
	$\cdot$The orbiter reenters and returns unpowered. 
	
	\\
	\hline \small 
	\textbf{Tohoku University TSTO Launcher}\cite{Takahashi1997}\newline\newline
	Developed by Takahashi et al.\cite{Takahashi1997}, a conceptual TSTO system was designed to investigate acceptable launch, landing and abort sites along the coast of the Japanese islands. 
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/Takahashi Vehicle"}}
	
	$\cdot$First stage reusable. 
	
	$\cdot$2000kg payload to LEO. 
	
	$\cdot$The booster weighs 75.0ton, and is 30m long, while the orbiter weighs 19.7ton, and is 19m long.
	
	$\cdot$The booster uses the air-turbo-ramjet engine developed at Japan's Institute for Space and Astronautical Science. The orbiter uses the LE-5B rocket engine. 
	
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/Takahashi Trajectory"}}
	
	$\cdot$Horizontal launch.
	
	$\cdot$Prescribed booster trajectory of flight at a maximum dynamic pressure of 50kpa. 
	
	$\cdot$The rocket stage is separated at Mach 6 and 50kPa dynamic pressure, after which it pulls-up to orbit under rocket power. 
	
	$\cdot$The booster stage glides downrange to a suitable landing site.
	
	
	\\
	\hline \small 
	\textbf{S{\"a}nger (Saenger)}\cite{Aberleen}\newline\newline
	The S{\"a}nger was a German TSTO alternative to the HOTOL. S{\"a}nger was intended to drive studies and technology development within the German Hypersonic Technology Program (HTP). 
	
	
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/Saenger"}}
	
	$\cdot$First stage with a weight of 405t and length of 82.5m. Two alternative upper stages; a reusable, manned version for a crew of four and 3t payload, and an expendable cargo version for carrying 7-8t payload to LEO. 
	
	$\cdot$First stage powered by tubojets and ramjets, with upper stages powered by conventional LOX/LH2 rockets. 
	
	&\small
	$\cdot$No detailed trajectory information available beyond separation to second stage at Mach 6.6. 
	\\
	\hline \small 
	\textbf{Dassault Aviation Star-H / HERMES} \cite{Aberleen}\newline\newline
Developed by Dassault, the STAR-H was the French study that sought to mirror the HOTOL and S{\"a}nger with the design of an aerospace plane capable of servicing the ISS. The STAR-H incorporates the Hermes, a Euopean manned launcher concept, as 'payload' making it essentially a two-and-a-half stage vehicle. 
	
	%https://books.google.com.au/books?id=vLadDQAAQBAJ&pg=PA178&lpg=PA178&dq=dassault+starh&source=bl&ots=FzPe3XdDWu&sig=ACfU3U3dDHG34_X23TOZZcmJMjKLW-eMGw&hl=en&sa=X&ved=2ahUKEwiphJi588zjAhVFfX0KHTuGBCsQ6AEwB3oECAgQAQ#v=onepage&q=dassault%20starh&f=false
	
	%https://books.google.com.au/books?id=06UzDwAAQBAJ&pg=PA173&lpg=PA173&dq=starh+launcher&source=bl&ots=bo5UbMwTGU&sig=ACfU3U1V86V5Gkzmpd74tfExJkxzv6ugow&hl=en&sa=X&ved=2ahUKEwjqj6es88zjAhXUXCsKHTitCnwQ6AEwCnoECAgQAQ#v=onepage&q=starh%20launcher&f=false
	&\small
\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/StarH"}}

$\cdot$First stage weighing 299t, with a second stage weighing 101t, with the Hermes spaceplane as 'payload'. 

$\cdot$First stage powered by five combined cycle engines, second stage rocket powered. 
	
	&\small
	$\cdot$No detailed trajectory information is available beyond separation to second stage at Mach 6. 
	
	\\
	\hline \small 
	\textbf{Starsaber}\cite{Germain2001}\newline\newline
	Starsaber was a conceptual design produced by the Georgia Institute of Technology Space Systems Design Lab, with the collaboration of NASA's Marshall Space Flight Centre. Starsaber was intended to investigate the feasibility of RBCC engines for small payload class missions. 
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/Starsaber"}}
	
	$\cdot$300lbs (136kg) payload. 
	
	$\cdot$The reusable booster weighs 79150lbs (35902kg) and is 77ft (23.5m) long, and the expendable orbiter weighs 3400lbs (1542kg) and is 13.1ft (4.0m) long. 
	
	$\cdot$The booster is powered by two RBCC (ejector-ramjet/ramjet/rocket) engines, while the orbiter is powered by rocket engines.  
	
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/StarsaberTraj"}}
	
	$\cdot$Trajectory optimised in separate stages for minimum fuel, constrained to vehicle design and trajectory events. 
	
	$\cdot$Horizontal launch.
	
	$\cdot$Takeoff occurs in ejector-ramjet mode, accelerating to the maximum dynamic pressure boundary of 1500psf (71.8kPa), at which point transition to ramjet mode occurs. 
	
	$\cdot$Constant dynamic pressure is maintained throughout ramjet operation, before transition to all-rocket mode.
	
	$\cdot$The vehicle pulls-up in all-rocket mode, and separates the orbiter when the dynamic pressure falls below 1psf (0.05kPa), which continues to orbit under rocket power.
	
	$\cdot$The booster descends and returns to the launch site under ramjet power, choosing the altitude at which lift equals weight for a constant angle of attack. 
	
	\\
	\hline \small 
	\textbf{QuickSat}\cite{Eklund2012}\newline\newline
Quicksat was designed by SpaceWorks Engineering and the Air Force Research Lab as a conceptual exploration of combined cycle propulsion systems for reusable space access. Quicksat was developed in support of a U.S. military initiative to investigate responsive space access for national security purposes. Quicksat is capable of both the orbital delivery of a Space Manoeuvre Vehicle, as well as hypersonic strike. 
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/Quicksat"}}
	
	$\cdot$500lbs (226.8kg) payload. 
	
	$\cdot$The booster stage weighs 77125 (34983kg) and is 52.2ft (15.9m) long while the orbiter weighs 13090lbs (5937kg) and is 27.5ft (8.4m) long.
	
	$\cdot$The booster is powered by turbojets, dual-mode scramjets, and rockets, while the orbiter is rocket powered.
	
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/QuicksatTraj"}}
	
	$\cdot$Horizontally launched under turbojet power.
	
	$\cdot$Rockets are used through the transonic regime.
	
	$\cdot$Turbojets are again used along a dynamic pressure of 1600psf (76.6kPa). 
	
	$\cdot$At Mach 3.75, the vehicle transitions to ramjet power, and flies at maximum dynamic pressure of 2000psf (95.7kPa), transitioning to scramjet power when necessary.
	
	$\cdot$At Mach 8, a pull-up is initiated, and the vehicle transitions to rocket power. 
	
	$\cdot$At 250000ft, staging occurs, and the orbiter circularises under rocket power. 
	
	$\cdot$The booster reenters, decelerates, and returns under turbojet power.  
	\\
	
	\hline \small 
	\textbf{XCALIBUR}\cite{Bradford2002}\newline\newline
	XCALIBUR was designed by SpaceWorks Engineering in support of NASA Marshall Space Flight Center’s Advanced Space Transportation Program (ASTP). The XCALIBUR design was intended to investigate the viability of RBCC engines for future reusable launch vehicles. 
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=0.48\linewidth]{"figures/2_literature-review/XCALIBUR1"}}
	\raisebox{-\totalheight}{\includegraphics[width=0.48\linewidth]{"figures/2_literature-review/XCALIBUR2"}}
	
	$\cdot$Fully reusable. 
	
	$\cdot$The booster stage is powered by four RBCC engines, while the orbiter is HEDM rocket powered. 
	
	$\cdot$20000lbs (9071kg) payload.
	
	$\cdot$The booster weighs 897790lbs (407231kg)and is 181.7ft (55.4m) long, and the orbiter weighs 103710lbs (47042kg) and is 42.4ft (12.9m) long.  
	
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/XCALIBURTraj"}}
	
	$\cdot$Vertical launch.
	
	$\cdot$The maximum dynamic pressure pf 1800psf (86.2kPa) is flown during ramjet and scramjet operation, for maximum engine performance. 
	
	$\cdot$At Mach 10, pull-up occurs under scramjet power, in order to reach staging conditions of 95psf (4.5kPa) dynamic pressure. 
	
	$\cdot$The upper stage injects into orbit using rocket boosters. 
	
	
	\\
\hline 
\end{xltabular} 
\end{landscape}
}

The most obvious and studied alternative to single-stage-to-orbit for an airbreathing launch vehicle is the two-stage-to-orbit configuration. The TSTO configuration generally separates the launch system into an airbreathing or airbreathing/rocket-powered 'booster' stage, and a rocket-powered 'orbiter' stage. This configuration allows for the separation of the booster stage after the airbreathing engines are no longer able to be used due to low air density or high Mach number. This separation removes a large fraction of the system mass, as the airbreathing engines are generally complex and heavy systems. As a consequence of this mass reduction, the rocket engines used for the final acceleration to orbit may be considerably smaller, and therefore cheaper and lighter. Table XXX summarises the TSTO airbreathing launch systems that have gone through a detailed design process, along with their key design and trajectory features. 



TSTO systems may be designed to be fully or partially reusable, generally the booster stage returns to launch site, while the orbiter stage may be returned, or discarded. Returning the orbiter stage is a more complex task than returning the booster stage, due to its high velocities, as well as generally being a much smaller vehicle, meaning that the relative mass penalties for including the systems necessary for reuse are more severe. However, the ability to have an expendable orbiter stage, and a reusable booster, makes partial-reusability more attainable for small launch systems. 
Consequently, the TSTO airbreathing launchers that have been investigated are designed for a wider range of payload masses than the SSTO systems, including the small payload launchers Starsaber and QuickSat. The booster stages are all powered by airbreathing engines, although a more varied array of engine architectures can be observed in the TSTO vehicles when compared to SSTO vehicles. RBCC engines are still common, however the inclusion of turbojets is more prevalent in TSTO designs, and some designs eschew the use of rocket engines in the booster stage altogether. This is due to the separation of the booster stage allowing for more emphasis to be directed towards fuel efficiency, rather than mass efficiency, within the engine systems. 

The trajectories of TSTO airbreathing launch systems, where available, are relatively similar to those of SSTO launch systems. All of the systems that have been studies are launched horizontally, and fly at the maximum dynamic pressure boundary for the majority of the duration of hypersonic airbreathing flight. Near the end of airbreathing operation, a pull-up is generally performed, similarly to the pull-up observed in SSTO launchers, before stage separation. However, this pull-up is not always observed, and when it is observed, it occurs to very different extents, so that separation is initiated at vastly different altitudes and velocities between launch systems. 
This variety of staging points is due to the location of the staging point being determined by a wide variety of factors. At a stage transition point there is generally a large change in the mass and aerodynamics of the launch system, as well, that makes finding the optimal stage transition point complicated. To find the optimal separation point there is a trade-off between;
\begin{itemize}
	\item the high efficiency of the scramjet engines;
	\item the thrust produced by the scramjet engines;
	\item the potential thrust of the rocket engines;
	\item the energy necessary to increase the altitude of the scramjet stage;
	\item and the aerodynamic efficiency when performing the required direction change.
\end{itemize}
All of these factors must be considered in order to generate an optimal trajectory. In addition, the staging point may be significantly limited by the design of the launch system, particularly if the orbiter stage is limited by structural or thermal requirements. 

The optimal point at which staging occurs from airbreathing to rocket stages is of considerable interest for the development of a small rocket-scramjet-rocket launch system, as maximising the performance of the launch system is critical. 



There has been a number of studies which have identified a pull-up manoeuvre as being advantageous for a multi-stage system in order to decrease the dynamic pressure of the vehicle at airbreathing-rocket stage separation\cite{Tsuchiya2005,Wilhite1991,Mehta2001}. 
In the studies by Tsuchiya et al.\cite{Tsuchiya2005} and Wilhite et al.\cite{Wilhite1991}, decreased dynamic pressure is necessary for the successful operation of the orbital rocket stages, of the systems under investigation. In these studies the airbreathing stages pull-up to the maximum allowable dynamic pressure for the rocket-powered orbital stages. When the orbital stages are able to operate, stage separation occurs. These pull-up manoeuvres demonstrate the advantages of a pull-up for the operation of the orbital stages, allowing the aerodynamic and thermal loading on the vehicle to be reduced. However, these pull-up manoeuvres are not performed as part of optimal trajectories, instead they are designed to ensure that the performance constraints of the systems are met. 
Mehta \& Bowles\cite{Mehta2001} prescribe a 2g pull-up in order to ``lower dynamic pressures and to achieve the optimal launching flight path angle for the orbiter vehicle". This prescribed manoeuvre indicates that a pull-up before airbreathing-rocket transition is considered the optimal trajectory, although the specific optimal conditions are not investigated. 
While a pull-up is generally performed under airbreathing power for the majority of multistage launchers, this is not the case for the Tohoku University Launcher, nor the Starsaber. The Tohoku University Launcher maintains constant dynamic pressure until separation, and the rocket stage is performs the pull-up to orbit under its own power, while the Starsaber transitions to rocket mode during constant dynamic pressure flight, and pulls up under rocket power. This may indicate that it is preferable for the booster vehicle to stay close to maximum dynamic pressure during airbreathing operation, when it is able to do so. This is supported by a study by Staufenbiel\cite{Staufenbiel2000}, which investigated the effects of staging conditions on a second stage rocket in isolation, and concluded that "higher Mach numbers are preferable to increasing the flight-path angle above values of a few degrees". However, this study did not include an airbreathing stage optimisation, and specifically stated that the airbreathing stage must be included to determine optimal separation conditions\cite{Staufenbiel2000}. 




  \textcolor{red}{
  \subsection{Three-Stage Launch Systems}
}
	
\afterpage{
\begin{landscape}


\begin{xltabular}{\linewidth}{|X|X|X|}
	\hline \small  \textbf{Launcher} &\small \textbf{Design} &\small \textbf{Trajectory}\\ 
	\hline \small 
\textbf{Tohoku University 3STO}\cite{Kimura1999} \newline \newline Kimura and Sawada investigate a three-stage-to-orbit launch system with an expendable upper stage for responsive LEO launch.
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/Kimura"}}
	
	$\cdot$2t of payload to LEO. 
	
	$\cdot$Weight: First stage 123.42t, second stage 61.89t, third stage 11.27t.
	
	$\cdot$Length: First stage 50m, second stage 26m, third stage 16m. 
	
	$\cdot$Propulsion: First stage four air-turboramjets, second stage scramjet, third stage rocket. 
	
	
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/KimuraTraj"}}
	$\cdot$Horizontal takeoff. 
	
	$\cdot$Trajectory is prescribed a priori.
	
	$\cdot$First stage flies at a constant dynamic pressure of 20kPa, before staging at 30km altitude, at Mach 5-6.
	
	$\cdot$The second stage ascends under scramjet power along a predefined trajectory that is designed to avoid violating maximum heating constraints, at a low trajectory angle, before staging at 50km altitude, at Mach 11-12.
	
	$\cdot$The third stage ascends under rocket power. 
	
	$\cdot$The first and second stage land at a site downrange. The first stage cruises under turbojet power , while the second stage glides. 
	

	\\
	\hline \small
	\textbf{SPARTAN}\cite{Preller2018a} \newline\newline
	The SPARTAN is a three stage, partially reusable, access to space system under development at The University of Queensland\cite{Jazra2013,Preller2018a} and Hypersonix(CITEXXX). Designed for affordable small payload launch, The SPARTAN is partially-reusable. 
	&\small
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/SPARTAN"}}
	
	$\cdot$Payload: 279.8kg
	
	$\cdot$Weight: First stage 11957.6kg, second stage 5905.1kg, third stage 2850kg.
	
	$\cdot$Length: Second stage 22.94m, third stage 11.8m. 
	
	$\cdot$Propulsion: Rocket-scramjet-rocket
	
	
	&\small
	
	\raisebox{-\totalheight}{\includegraphics[width=\linewidth]{"figures/2_literature-review/SPARTAN_traj1"}}
	
	$\cdot$Vertical launch.
	
	$\cdot$First stage performs a gravity turn. 
	
	$\cdot$Trajectory constrained to scramjet stage flying a constant dynamic pressure of 50kPa. 
	
	$\cdot$Third stage ascends under rocket power, held at 10$^\circ$ angle of attack. 
	
	$\cdot$Return trajectory undefined. 
	
	\\
	\hline
\end{xltabular}

\end{landscape}
}

Three-stage-to-orbit (3STO) airbreathing systems are by far the least studied configuration of airbreathing launch system. This is due to two stages being previously reckoned as the maximum number of stages necessary for an efficient, fully-reusable airbreathing launcher, with one stage powered by airbreathing engines sometimes augmented with rocket engines, and another stage powered by rocket engines only. However, if the launcher is not fully-reusable it may be advantageous to further separate the launch system into a three-stage configuration. A three-stage configuration allows for cost-efficient partial-reusability in small launchers, enabling the acceleration of a small, disposable third stage, with reusable first and second stages. 
3STO systems are likely to be most applicable to smaller launch systems, where any 'dead' weight from unused propulsion systems at hypersonic speeds carries relatively larger mass penalties when compared to more massive systems. 

The three-stage airbreathing launchers that have been or are being investigated are summarised in Table \textcolor{red}{XXX}. Only two such systems have been identified; the Tohoku University 3STO launch system investigated by Kimura and Sawada in 1999\cite{Kimura1999}, and The SPARTAN, a rocket-scramjet-rocket launch system currently under development by the University of Queensland and Hypersonix. Both of these systems are designed to be a cost effective near-term solution to airbreathing access to space, using a disposable third stage rocket along with reusable first and second stages. Both stages use second stages powered by scramjets, with The SPARTAN utilising a rocket-powered first stage along with vertical launch, while the Tohoku University launcher utilises turboramjets along with a horizontal launch, in a plane-like configuration. 


Both the Tohoku University launcher and the SPARTAN fly close to the maximum limits of the vehicle during airbreathing operation. The flight paths of both of these launch systems are predefined, and designed around the physical limits of the launch systems.  
While this is believed to be the most optimal or representative trajectory for these launch systems, no analysis has been undertaken to indicate that these trajectories are in fact the most efficient way of flying to orbit. This is particularly true for the SPARTAN, because the fly-back of the scramjet stage has not been modelled, even though it is an integral part of the cost effectiveness of the launch system. 
When compared to the trajectories flown by two-stage-to-orbit airbreathing launch systems, it is evident that a pull-up during airbreathing operation, before the release of the third stage, may possibly improve the efficiency of the launch system. Although the extent of this pull-up, or indeed whether a pull-up is necessary at all, cannot be easily estimated from the previous studies on two-stage launch systems.

This study seeks to model a rocket scramjet-rocket launch system, of which the SPARTAN is the only example that has undergone detailed design. This work will utilise a modified version of the SPARTAN launch system as a basis for trajectory analysis research on rocket-scramjet-rocket launch systems. 


\subsubsection{The SPARTAN - Design}

%\textcolor{red}{XXX make note of vertical launch}

 The SPARTAN launch system system is considered in this study as a representative model for three stage, airbreathing access to space system designs. 
 Access to the detailed design of the SPARTAN has been provided by the University of Queensland, where this work has been undertaken.
 
 The SPARTAN launch system is in the preliminary design phases, undergoing research and design to assess the feasibility of a rocket-scramjet-rocket multi-stage airbreathing launch system for small satellite launch. 
 The SPARTAN system is based around the scramjet accelerator, and the scramjet accelerator is the first stage that has been designed in detail, because the development and performance of the scramjet accelerator are likely to be the most critical aspects of the launch system design. 
 The scramjet accelerator stage of the SPARTAN was first designed by Jazra, Preller and Smart\cite{Jazra2010, Jazra2013}, based on the winged-cone vehicle developed by Shaughnessy et al. as part of the NASP program\cite{Shaughnessy1990}. The scramjet stage in this work is a modified version of the Baseline scramjet accelerator stage designed by Preller \& Smart\cite{Preller2018a,Preller2017b}, defined as The SPARTAN by Preller, although the nomenclature has since been changed so that The SPARTAN refers to the entire launch system. The scramjet accelerator used in this study uses the general fuselage shape and control system to the Baseline vehicle designed by Preller \& Smart, and is detailed in Section \textcolor{red}{XXX}. However, the third stage in this work will be situated internally within the scramjet accelerator vehicle, similarly to the scramjet accelerator designed by Jazra, Preller and Smart\cite{Jazra2013}. 
 
\begin{figure}[ht]
\centering
\includegraphics[width=0.7\linewidth]{figures/2_literature-review/SPARTAN-Dawid}
\caption{The scramjet accelerator of the SPARTAN, as designed by Preller\cite{Preller2018a}.}
\label{fig:SPARTAN-Dawid}
\end{figure}


The first stage has not yet been modelled in detail, with only very representative aerodynamic models used for analysis of a non-reusable first stage rocket.
It is eventually intended that first stage of The SPARTAN be returnable to launch site under cruise-back power for reuse. Some preliminary work has been carried out, exploring the reuse of the first stage boosters of The SPARTAN \cite{chai2017} for a modified, reduced size SPARTAN concept, however this work is still in its infancy. 
 This work will build on the design of the SPARTAN by designing a non-reusable first stage rocket, to align with the work that has previously been completed\cite{Preller2017b}. 


The third stage rocket separates from the SPARTAN at the end of its trajectory, and performs a pull-up manoeuvre to exit the atmosphere. The third stage rocket of the rocket-scramjet-rocket launch system consists of a rocket motor, fuel tanks, structure, payload and a thermal protection system\cite{Preller2017b}, shown in Figure \ref{fig:ThirdStage}. Once the density of the atmosphere is low enough, the thermal protection system separated from the vehicle for mass efficiency, and once exoatmospheric, the third stage performs a Hohmann transfer to reach the desired orbit. 
\begin{figure}[ht]
	\centering
	\includegraphics[width=0.7\linewidth]{figures/2_literature-review/ThirdStage}
	\caption{The third stage rocket of the rocket-scramjet-rocket launch system\cite{Preller2017b}.}
	\label{fig:ThirdStage}
\end{figure}
The third stage has to this point been designed to be powered by the Pratt \& Whitney RL-10-3A\cite{Preller2017b}, and has exhibited good performance when powered by this engine. However, the RL-10-3A is a pump-fed engine, and is likely to be prohibitively expensive for a small launch system. This work modifies the design of the third stage significantly, to be powered by a thrust-enhanced Kestrel engine. This is a more modern, and much cheaper engine, that is more accurately representative of the sort of engine that a launch system of this type will need to use in order to be cost effective. 
 

\subsubsection{The SPARTAN - Trajectory}

\begin{figure}[!ht]
	\centering
	\includegraphics[width=0.9\linewidth]{figures/2_literature-review/SPARTAN_traj1}
	\caption{The flight trajectory of the SPARTAN. a) shows the physical trajectory and b) shows the forces on the vehicle and performance indicators.}
	\label{fig:SPARTAN_traj}
\end{figure}

To date, studies of the SPARTAN have assumed a constant dynamic pressure trajectory\cite{Preller2017b}.
Past studies of the SPARTAN vehicle have assumed that a fly-back to launch site is possible after third stage separation\cite{Preller2017b}. However, this fly-back has not yet been simulated. 
\begin{figure}[ht]
	\centering
	\includegraphics[width=0.7\linewidth]{figures/2_literature-review/SPARTANElevons}
	\caption{The elevons of the SPARTAN\cite{Preller2017b}.}
	\label{fig:SPARTANElevons}
\end{figure}
Figure \ref{fig:SPARTAN_traj} shows the trajectory of the SPARTAN, simulated in three degrees of freedom to fly close to a constant 50kPa dynamic pressure, using a pole-placement angle of attack controller\cite{Preller2017b}.
The ascent trajectory of the SPARTAN begins at Mach 6, and terminates at Mach 9.34, when the hydrogen fuel is exhausted\cite{Preller2017b}. 
The net specific impulse of the SPARTAN varies from 1492s at the beginning of the trajectory, to 439s by the time the fuel is depleted\cite{Preller2017b}. This significant decrease in efficiency means that by the end of the trajectory, the net efficiency of the SPARTAN is approximately that of a rocket\cite{Preller2017b}.
The SPARTAN is trimmed throughout the trajectory by ailerons on the wing, shown in Figure \ref{fig:SPARTANElevons}. These elevons were sized through variation of the width, $b_E$, to have an area equal to 15\% of the area of the wing, and to have a cord length, $c_E$, of 15\% of the cord length of the wing\cite{Preller2017b}. Over the flight of the SPARTAN, the flap deflection changes from 10.6$^\circ$ to 12.2$^\circ$\cite{Preller2017b}. The drag contribution of the flap varies from 14.3\% to 14.5\%, and the lift contribution from 18.8\% to 21.0\%\cite{Preller2018a}. 

This trajectory enables the delivery of 279.8kg of payload to sun synchronous orbit, when using a third stage powered by a Pratt \& Whitney RL-10-3A\cite{Preller2018a}. 
This trajectory was designed around the SPARTAN flying a constant dynamic pressure trajectory, with the third stage and first stage trajectories confirming to this constraint. It has been suggested that for the design of this launch system to be improved, an optimised trajectory is necessary\cite{Preller2017b}.


%\textcolor{red}{numbers are from prellers thesis, not paper. Might need to be clear on this}

\subsection{Hypersonic Vehicle Return and Glide Trajectories}



%\textcolor{red}{XXX  I should have the space shuttle in thiss eciton}



\textcolor{red}{
The fly-back of the SPARTAN scramjet-powered stage has not yet been analysed or simulated in any of the studies yet performed.  
This is an essential component of the launch mission if the SPARTAN concept is to be commercially viable, and is a complex task. The scramjet powered stage releases at high velocity, greater than Mach 9, and must turn and fly-back to its launch site either by gliding or under power of only the scramjet engines. When compared to other multi-stage airbreathing launch systems, these fly-back conditions are significantly different. Other launchers either use low speed turbojets to cruise-back to their launch site, separate at a significantly lower Mach number, or fly to a site down-range. For this reason, the return options of hypersonic vehicles must be studied, along with the maximum range trajectories of hypersonic glide and strike vehicles, to understand the best way to return the SPARTAN's scramjet accelerator vehicle to its launch site. 
}

There are three main methods that have been studied for potential hypersonic vehicle return; glide-back, cruise-back and boost-back. Glide-back involves the hypersonic vehicle returning to base and landing entirely using its aerodynamics. This requires sufficient lift to sustain the hypersonic vehicle over the entire return range, as well as the controllability to land the hypersonic vehicle in level flight. 
For a hypersonic trajectory a fully glide-back return flight is most likely unobtainable. This is due to the large downrange distance flown, and the large initial velocity at the beginning of the fly-back trajectory, when the vehicle is oriented away from the landing site. Multiple studies have investigated the maximum staging velocity allowable for the glide-back flight of a booster, and have found that the maximum separation velocity for glide-back to be feasible has been found to be between Mach 3-4 at 30km-120km downrange distance, with higher initial velocities or longer downrange distances requiring fly-back under power\cite{Hellman,Tetlow1992}.

Cruise-back involves the inclusion of subsonic engines, which are used to power the fly-back of the hypersonic vehicle until landing similar to a conventional aircraft. These engines may be included solely for the fly-back\cite{Hellman}, or used in the acceleration phase for low velocity acceleration\cite{Mehta2001,Tetlow1992,Wilhite1991}. The addition of subsonic engines powering a constant velocity cruise-back phase allows the accelerator to return to base with a similar trajectory to that of traditional aircraft, allowing the velocity and altitude of the accelerator to be precisely controlled. However, the addition of subsonic engines necessary for cruise-back increases the mass of the vehicle significantly, leading to decreased mass efficiency and increased design complexity\cite{Hellman}. 

A preferable mode of powered fly-back is to use the existing hypersonic airbreathing engines during the return trajectory in a boost-back trajectory. Using the existing airbreathing engines allows for range to be added to a return trajectory, without the inclusion of additional engines. The hypersonic airbreathing engines can be operated at appropriate times during the fly-back, when they will be most impactful on the return trajectory range. However, the hypersonic airbreathing engines may only be used within their operating region, and vary in thrust and efficiency dependent on flight conditions. Hypersonic airbreathing engines have maximum efficiency at low Mach numbers\cite{Preller2017b}, with the thrust produced depending on the dynamic pressure and inlet conditions, which vary with the trajectory path and angle of attack of the vehicle. 
The possibility of an airbreathing vehicle reigniting high speed airbreathing engines for short periods has been investigated by Tsuchiya and Mori\cite{Tsuchiya2005}.  Tsuchiya and Mori investigate two conceptual launch vehicles; a vehicle powered solely by airbreathing propulsion returning after separation of an orbital stage at Mach 5.1, and an airbreathing/rocket vehicle returning after a separation at Mach 6.8\cite{Tsuchiya2005}.  Both vehicles use the high speed airbreathing engines during return flight. The optimal launch and return trajectories for these vehicles are shown in Figure \ref{fig:Tsuchiya}. Both vehicles ignite the airbreathing engines at around Mach 3.5 for ``several tens of seconds" to extend the range of the fly-back manoeuvres. After this, the vehicles descend and land at the launch site. 
These boosters fly to a downrange distance of 600-625km from the launch site, and less than 5\% of the vehicles initial propellant was required to return the vehicles to the initial launch sites\cite{Tsuchiya2005}. However, these boost-back trajectories were initiated at a significantly lower velocity when compared to the release of the SPARTAN's third stage from the scramjet accelerator stage, at greater than Mach 9. It is necessary to investigate whether a scramjet stage is likely to be capable or return flight under its own power, and what the most efficient trajectory is likely to be. 
\textcolor{red}{In addition, if powered fly-back is necessary, the additional fuel weight used during this phase can negatively impact on the potential performance of a launch system. The effect of the fly-back of the scramjet-powered stage on the efficiency of the launch system must be assessed, to determine the functional implications of mandating return-to-launch-site capabilities. }

\textcolor{red}{
The maximum-range, minimum-fuel trajectories of hypersonic vehicles and lifting bodies may allow a better understanding of the potential maximum efficiency return trajectory. The maximum range trajectory of a hypersonic vehicle operating at high altitudes is well understood to be a `skipping' trajectory, where the altitude of the vehicle is repeatedly raised and lowered to take advantage of the most efficient angle of attack of a vehicle while travelling through high density air\cite{Moshman2014,Darby2011,Toso2015,Chai2015}.} A skipping trajectory has been shown to be range optimal for hypersonic vehicles able to skip out of the atmosphere\cite{Eggers1957,Moshman2014}, as well as vehicles flying entirely within the atmosphere\cite{Moshman2014,Darby2011,Toso2015,Tetlow1992}. A skipping trajectory has also been shown to be optimal for an airbreathing hypersonic vehicle thrusting throughout the trajectory\cite{Kanda2007,Chai2015}, as shown in Figure \ref{fig:chai-boostskip}. The range optimal operation of the scramjet engine is shown to be repeated ignitions at the trough of each skip\cite{Chai2015}. The scramjets are ignited as the vehicle climbs after the trough, as the Mach number decreases to the minimum operable conditions of the scramjet engines\cite{Chai2015}. Minimising the Mach number during operation in this way maximises the efficiency of the scramjet engines\cite{Chai2015}.
 \begin{figure}[ht]
 	\centering
 	\includegraphics[width=0.9\linewidth]{"figures/2_literature-review/chai-boost skip"}
 	\caption{\textcolor{red}{An illustration of }the optimised maximum range trajectory of a hypersonic vehicle\cite{Chai2015}.}
 	\label{fig:chai-boostskip}
 \end{figure}

\textcolor{red}{
In order to determine the most efficient return trajectory for the SPARTAN's scramjet accelerator stage, an optimal trajectory must be developed that allows the scramjet accelerator to ignite its engines if necessary, and also allows for a high level of freedom while manoeuvring during return. 
}


\section{Optimal Control}\label{sec:Optimisation}

%\textcolor{red}{XXX ingo: I need to clearly situate how this fits relative to GNC}

%\textcolor{red}{XXX I need to frame this as 'this is how optimisation has been used, it is useful in these ways, whis is why im doing what im doing, ie here is some examples of successful multiple shooting or collocation'}



\textcolor{red}{In order to investigate the best possible way to fly The SPARTAN system to orbit, a simulation must be developed that will calculate the optimal flight path, taking into account the trajectory of all of the stages of the launch system, including ascent trajectories, as well as the return of the scramjet accelerator stage. 
Calculating the optimal trajectory of a launch system with multiple stages and multiple modes of propulsion is a complex process. 
Defining the trajectory of a launch system purely from vehicle analysis is unlikely to yield a trajectory which maximises the performance of the system.
A simulation method is required which is able to calculate a trajectory path which maximises the performance of the launch system, while taking into account the aerodynamic and propulsive properties of each stage and propulsion mode. 
Optimal control theory is used in situations where an control sequence must be found to minimise or maximise an objective function with little prior knowledge. 
Optimal control theory has been widely used in aerospace applications, including being used to optimise the launch of airbreathing hypersonic launch vehicles\cite{Powell1991,Lu1993,Trefny1999,Roche2000,Pescetelli2012,Young2006}, \textcolor{red}{as detailed in Section \ref{sec:AscentTrajectories}}.
}
% Need to expand on this a bit, cite some books and define optimal control


For an optimisation of a complex trajectory there are a variety of numerical methods that are useful for specific problem types. These are separated into two categories: direct and indirect solution methods\cite{Betts1998}. Indirect methods are based on the calculus of variations or minimum principle model, and generally result in high accuracy solutions to optimisation problems\cite{Bulirsch1993}. However indirect models suffer from the drawbacks of small radii of convergence and the fact that the equations to be solved often exhibit strong nonlinearity and discontinuities. This means that indirect methods will not be solvable unless the problem is very well defined with a minimum of nonlinearity, making indirect methods unsuitable for many complex optimisation problems, such as aerospace vehicle simulations which can exhibit strong nonlinear behaviour and have a wide solution space. 

Direct methods transform an optimisation problem into a nonlinear programming (NLP) problem which can be solved computationally\cite{Stryk1992}. NLP solvers solve the optimisation problem defined as\cite{Bazaraa2013}:

\begin{equation}
Minimise \qquad f(x)
\end{equation}

\begin{equation}
Subject \quad to \qquad g_i(x)\leq0 \quad for \quad i=1,...,m
\end{equation}

\begin{equation}
and \qquad h_j(x) = 0 \quad for \quad j=1,...,n
\end{equation}

An optimisation problem that has been discretised in this form can thus be solved using any of a variety of NLP solvers. One of the most effective methods of solving twice differentiable NLP problems is sequential quadratic programming (SQP)\cite{Boggs2000} for which there is a variety of commercial solvers available such as NPSOL, SNOPT, and packages within MATLAB. 

In order for these packages to be able to solve an optimisation problem it must be presented in discretised form, and as such must be transformed using transcription techniques\cite{Kelly2015}. The task of transcribing a continuous optimisation problem into discrete NLP solvable form is not simple. SQP solvers can very easily run into convergence issues when provided with an optimisation problem which has not been well defined. Also, any transcription must be carried out with care that the accuracy of the solution is not compromised. 
There are multiple ways to approximate a continuous optimisation problem directly as an NLP problem, the most common of which are shooting and collocation methods. The choice of discretisation method can affect the stability and accuracy of the solution as well as the solution time of the problem. 

\subsection{Shooting Methods}

Shooting methods in optimal control are forward-time methods of discretisation\cite{Kelly2015}. Shooting methods explicitly enforce the dynamics of the system, and update the free conditions and system controls to move towards an optimal solution from an initial guess\cite{Kelly2015}. Shooting methods are generally simple to apply, and require little specialised knowledge to use once they have been implemented. 


\subsubsection{The Single Shooting Method}

The oldest and simplest method of approximating continuous optimisation problems as NLP problems is the direct single shooting method. Direct single shooting discretises the control function over the solution space, and solves this directly as an NLP by integrating the vehicle dynamics, or state variables, along the trajectory at each trajectory guess\cite{Betts1998,Kelly2015,Rao2009,Fasano2013}. Single shooting is simple to apply and has been used since the 1970s for rocket trajectory optimisation\cite{jezewski1971}. Single shooting methods suffer from nonlinearity problems, ie. an optimisation problem solved using the single shooting method will potentially struggle to solve if the problem exhibits even small nonlinearities, due to being unable to converge to an optimal solution. This makes the single shooting method unsuitable for complex problems such as a scramjet model, as there are many nonlinear factors inherent in atmosphere and airbreathing engine modelling.


\subsubsection{The Multiple Shooting Method}

Direct multiple shooting solves some of the instabilities of the single shooting method by splitting the trajectory into multiple shooting arcs, and collocating these at specific time points\cite{Betts1998,Kelly2015,Rao2009,Fasano2013}. This creates a system of discontinuities, illustrated in Figure \ref{fig:multipleshooting}, which are gradually minimised by the solver algorithm until the trajectory is continuous. These discontinuities allow greater flexibility for the solver than is afforded by the single shooting method. 

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.9\linewidth]{SingleMultiple}
	\caption{A comparison of single shooting and multiple shooting\cite{Kelly2015}.}
	\label{fig:multipleshooting}
\end{figure}

The multiple shooting method has greatly improved convergence compared to the single shooting method, removing much of the susceptibility to instabilities resulting from nonlinear effects. However, the multiple shooting approach still suffers from a relatively small radius of convergence and slow computation times\cite{Fasano2013}. Radius of convergence is extremely important to this study as the optimal solution cannot be approximated to a great degree of accuracy, and as such multiple shooting was deemed inappropriate for this study. It was desired to find a method with a global radius of convergence to apply to the optimisation problem being considered.

% XXX I should be careful and maybe define global radius of convergence better

% XXX Put examples of where it has been used successfully here

\subsection{Collocation Methods}

Collocation methods are arguably the most powerful methods for solving optimal control problems\cite{Rao2009}. Collocation methods are simultaneous methods, where both the states and controls are approximated using a specific form of functional\cite{Kelly2015,Rao2009}. In these methods, the dynamics of the system are not explicitly enforced, but instead are constrained at specified points along the trajectory, called collocation points, or nodes\cite{Kelly2015}. This means that the derivative of the state functions become a constraint within the NLP, being equated to the polynomial approximation functions by the solver algorithm. 
Collocation methods provide larger radius of convergence, greater robustness, and smaller computational times compared to multiple shooting\cite{Fasano2013}. However, the solution accuracy of collocation methods is less than that of multiple shooting methods\cite{Fasano2013}, although this can be improved through the choice of basis functions used for collocation\cite{Rao2009}.

Collocation methods can be represented in two ways; \textsf{h} and \textsf{p} schemes\cite{Kelly2015}. \textsf{p} schemes, or global methods, represent the entire trajectory as high order polynomials, and converge by increasing the order of these polynomial\cite{Kelly2015}. This method works well if the underlying solution is smooth, however, if there are discontinuities present, a \textsf{p} scheme will fail\cite{Kelly2015}. \textsf{h} schemes separate the trajectory into a series of medium order polynomials, stitched together at set points using defect constraints, similarly to the multiple shooting method\cite{Kelly2015,Rao2009,Ross2004}. These joining points are called knot points\cite{Kelly2015,Ross2004}. A comparison between \textsf{h} and \textsf{p} methods is shown in Figure \ref{fig:HPExamples}.

\begin{figure}[ht]
	\centering
	\includegraphics[width=0.9\linewidth]{figures/2_literature-review/HPExamples}
	\caption{Examples of \textsf{h} and \textsf{p} collocation methods\cite{Kelly2015}.}
	\label{fig:HPExamples}
\end{figure}

\subsubsection{The Pseudospectral Method}\label{sec:PS}


The most accurate and effective type of collocation methods use orthogonal polynomials to approximate the state and control functionals\cite{Fahroo2000}. In trajectory optimisation, this type of collocation is referred to as the pseudospectral method\cite{Kelly2015}. 
The pseudospectral method was first introduced in 1972 by Kreiss \& Oliger\cite{Kreiss1972} as an efficient way to compute meteorology and oceanography problems. The pseudospectral method has recently garnered a large amount of attention for its ability to rapidly and accurately solve a wide variety of optimal control problems.  When a solution is well behaved and smooth, the pseudospectral method converges at an exponential rate, with a high accuracy known as spectral accuracy\cite{Ross2004,Darby2011a}. 

The pseudospectral method employs the use of orthogonal polynomials such as Legendre or Chebychev polynomials to approximate the state and control functions.
This approximation is used to transcribe the optimal control problem into a nonlinear programming problem (NLP) through collocation. This process involves mapping the time domain of the system is to the time interval $[-1,+1]$, and discretising the approximated dynamics at a specific set of points, obtained from Gaussian quadrature\cite{Fahroo2000,Huntington2007,Kelly2015,Rao2009,Garg2011}. 
There are multiple types of pseudpospectral methods, distinguished by the polynomial and collocation points used. Usually, these polynomials are Chebyshev or Lagrange polynomials\cite{Fahroo2000,Rao2009}, and the collocation points are the roots of a Legendre polynomial\cite{Garg2009}. Chebyshev polynomials have been used since the introduction of pseudospectral methods in optimal control, but have been superseded in many cases by Lagrange polynomials, which offer simpler collocation conditions\cite{Rao2009}. 
There are many possible types of collocation nodes, although there are three most commonly used sets; Legendre-Gauss (LG); Legendre-Gauss-Radau (LGR); and Legendre-Gauss-Lobatto (LGL)\cite{Garg2009,Rao2009}. The choice of collocation type determines how the roots of the problem are calculated, and changes the formulation of the problem slightly\cite{Garg2009}. Practically, there is very little difference between these node sets\cite{Garg2009}.
Detailed information on the pseudospectral information may be found in Reference \cite{Huntington2007}.


The pseudospectral method is usually employed as a \textsf{p} method, where a global polynomial is used, and convergence is achieved by increasing the order of this polynomial\cite{Rao2009}. Recently, \textsf{hp}-adaptive pseudospectral methods have been introduced, which segment the mesh using an h method, whilst also having a variable polynomial degree, as in the \textsf{p} method\cite{Darby2011a}. These \textsf{hp} methods converge by varying the degree of the approximating polynomial as well as the number of segments simultaneously. Utilising both \textsf{h} and \textsf{p} methods improves the accuracy and robustness of the solution, as illustrated in Figure \ref{fig:OptimisationMethodComparisonChai}, from a study by Chai et al.\cite{Chai2015} comparing the single shooting method to \textsf{p} (Gauss) and \textsf{hp}-adaptive pseudospectral methods. Additionally, the \textsf{hp}-adaptive method decreases the computational effort and memory usage necessary during the solution process\cite{Darby2011a,Chai2015}. 


\begin{figure}[ht]
	\centering
	\includegraphics[width=0.7\linewidth]{figures/2_literature-review/OptimisationMethodComparisonChai}
	\caption{Comparison of optimisation techniques\cite{Chai2015}. A hypersonic vehicle is optimised for maximum range. The \textsf{hp}-adaptive method can be observed to have produced the most optimal result.}
	\label{fig:OptimisationMethodComparisonChai}
\end{figure}

A secondary usability advantage of the pseudospectral method is the ability to generate Hamiltonian and costate values easily\cite{Gong2010,Fahroo2001,Rao2009}. The Hamiltonian and costate values allow a solution to easily and quickly be checked to determine if some of the necessary conditions for optimality are being met. This is useful to determine if the optimal solution calculated by the pseudospectral solver is valid.


The pseudospectral method has been proven to be extremely effective for simulations in aerospace applications and has been proven in flight applications such as the zero propellant manoeuvre of the International Space Station in 2007, where the ISS was rotated 180 degrees without any propellant used following a pseudospectral method solution\cite{Bedrossian}. 
The pseudospectral method has been used successfully in a multitude of studies for the trajectory optimisation of hypersonic vehicles\cite{Li2012,Josselyn2002a,Zhao2013,Tian2011,Darby2011,Chai2015,Rizvi2015,Moshman2014,Yang2017,Kodera2014}, and has proved an extremely effective tool. 
These results indicate that the pseudospectral method is robust for complex, nonlinear systems, and that the pseudospectral method can be used for systems with many state variables.

\textcolor{red}{XXX I might need to expand this, or point to section}

\section{Available Optimal Control Solvers}\label{sec:optsolvers}

There are a number of optimal control solvers available, both commercially and open source. A summary of the most prominent available solvers is shown in Table \ref{table:programs}. These programs are mostly general solvers, and must be configured specifically in order to solve a particular optimal control problem. The exception is ASTOS\cite{astos}, which is a standalone program designed for aerospace trajectory optimisation.

Functionally, most of the available solvers are similar in operation. The states and controls of the optimal control problem are defined to the program by the user, along with any constraints; continuous or endpoint. The cost function of the problem is input, and dynamic model of the system is defined. An initial guess is provided, and once activated, the solver will move toward an optimal solution from this initial guess. 
The most significant practical difference between the solvers lies in the robustness of the optimal solution, ie. how easily a particular solver is able to converge to the optimal solution. For a simple and continuous optimisation problem all solvers will be able to approach the same solution (though with varying efficiency). However, for a complex and nonlinear optimisation problem, some solvers will converge much more easily and rapidly than others. Generally, this stems from the underlying transcription method used. 
The most common form of discretisation used by these solvers is the pseudospectral method, although other forms of collocation, as well as multiple shooting, are also used. Of the methods used, \textsf{hp}-adaptive pseudospectral methods exhibit the best convergence and accuracy properties\cite{Chai2015}. The readily available packages which utilise \textsf{hp}-adaptive pseudospectral methods are GPOPS-2\cite{Rao2010} and ICLOCS2\cite{iclocs}.

ICLOCS2 is a software package in the alpha stages of development, which is based upon ICLOCS, a multiple shooting solver\cite{iclocs}. ICLOCS2 is able to implement a range of transcription methods, including a \textsf{hp}-adaptive Legendre-Gauss Pseudospectral method\cite{iclocs}. As ICLOCS2 is relatively new at the time of writing, it has not yet been implemented in any published works and documentation is limited. 

GPOPS-2 is a proprietary \textsf{hp}-adaptive pseudospectral method solver, which implements a variety of \textsf{hp}-adaptive pseudospectral methods, so that the best method may be chosen for a given problem\cite{Rao2010}. GPOPS-2 is specifically designed to be as flexible as possible, to accommodate for a wide range of problem formulations\cite{Rao2010}. GPOPS-2 is well proven in aerospace applications, and has been used for spacecraft orbit optimisation as well as in-atmosphere trajectory optimisation\cite{Rizvi2015,Lipp2014}. GPOPS-2 is well suited to solving multi-phase optimal control problems, which is necessary for efficient multi-stage launch optimisation\cite{Rao2010}. GPOPS-2 represents the state of the art in trajectory optimisation software, and as such is used by a number of institutions around the world. 

Both ICLOCS2 and GPOPS-2 uses IPOPT\cite{Wachter2006} (Interior Point OPTimizer) as the standard nonlinear programming solver (with the option of installing others). IPOPT is a widely used open source nonlinear optimisation package which utilises an interior point line search filter method. 

\begin{table}[ht]
	
	\begin{tabular}{|c|c|c| p{4cm}|}
		\hline \textbf{Software} & \textbf{Publisher} & \textbf{Platform} & \textbf{Optimisation Type} \\ 
		\hline DIDO\cite{Ross2002} & Elissar Global & MATLAB & Chebychev Pseudospectral \\ 
		\hline GPOPS II\cite{Rao2010} & RP Optimization Research & MATLAB & \textsf{hp}-Adaptive Legendre-Gauss-Radau Pseudospectral \\ 
		\hline PROPT (IPOPT)\cite{Rutquist2010}& TOMLAB & MATLAB & Legendre-Gauss  Pseudospectral  \\ 
		\hline ICLOCS2\cite{iclocs} & Imperial College & MATLAB &  Multiple Shooting / \textsf{hp}-adaptive Legendre-Gauss Pseudospectral  \\ 
		\hline POST2\cite{WilliamColson} & NASA & FORTRAN & Direct Shooting \\ 
		\hline OTIS\cite{otis} & NASA  & Fortran & Pseudospectral + Various  \\ 
		\hline TRANSWORHP\cite{Wassel2013} & ESA & Fortran/C++ & Full Discretisation \\ 
		\hline ASTOS\cite{astos} & Astos Solutions & Standalone & Multiple Shooting/Collocation  \\  
		\hline ACADO\cite{Houska2011} & Open Source & C++ &  Direct \\  
		\hline JModelica\cite{jmodelica} & Modelon AB, Open Source & Modelica/Python &  Collocation/ Pseudospectral \\  
		
		\hline 
	\end{tabular} 
	
	\caption{Summary of programs capable of pseudospectral optimisation.}
	\label{table:programs}
\end{table}















 







\section{Aerodynamic Analysis}

Simulating the trajectory of access to space systems requires the aerodynamics of each stage of the launch system to be characterised at every flight condition experienced during launch. For this to be possible, it is necessary to create large aerodynamic coefficient databases, which cover the operable region of the vehicle, and include the effects of control surface deflections and propulsion.

There are a variety of tools available to calculate the aerodynamics of aerospace vehicles.
 These tools are primarily designed towards either accuracy or efficiency, as more accurate methods require more computational power, longer computational times and, usually, more man-hours to produce a solution. 
This trade off means a tool must be selected which best suits the requirements of a given problem. 
For a preliminary vehicle design, it is often desirable to select a tool which is as computationally efficient as possible, as the design of the vehicle is liable to change often. 
Whereas for more advanced stages of vehicle design, an accurate tool is desirable, to assess the design of the vehicle in detail. 

The lowest fidelity, and highest efficiency methods include packages which use empirical relations derived from databases of existing vehicles, such as Missile Datcom\cite{Rosema2011}, as well as panel method codes such as HYPAERO\cite{Preller2017b}, cbaero\cite{Kinney2004} and HOTSOSE\cite{hotsose}. Low fidelity methods offer rapid solutions, with highly variable accuracy. For simple, standard vehicle shapes, low fidelity methods may offer high accuracy, as low fidelity solutions are usually calibrated to higher fidelity simulations or experiments. However, for complex vehicle geometries, for example geometries involving engine flow-paths, low fidelity models may be highly inaccurate, and are not acceptable for use\cite{Krause2011}. 

Medium fidelity methods consist of inviscid Euler solvers such as Cart3D\cite{CART3D} and FUN3D\cite{fun3d}, which are able to provide reasonable accuracy, with medium run times, by neglecting viscous effects within the solution. These solvers are often used in the later stages of preliminary design, or when higher fidelity is necessary due to design features, but rapid solutions are still desired.  Neglecting the viscous effects in the fluid flow means that the solution obtained from an inviscid solver will only be an approximation of the real flow, and that the accuracy of the solution varies depending on the type problem being solved. For problems such as lift on a thin airfoil, inviscid Euler methods may be quite accurate, however for a problem such as boundary growth on a flat plate these methods will not accurately model the solution\cite{NASAEuler}. A particular advantage that many inviscid Euler codes provide is automatic adjoint mesh adaptation, the ability for the mesh to be automatically and rapidly generated, and updated sequentially throughout the solution process, refining areas of complex geometry or flow. This enables multiple solutions to be easily computed, without the need to regenerate meshes manually. For preliminary design purposes, inviscid-flow Euler CFD solvers are used extensively across industry and academia\cite{Almosnino2016}, as they are able to capture the lift and drag of an aircraft sufficiently well. However, inviscid solvers naturally do not capture the aerodynamic forces on a vehicle due to viscous effects. This deficiency can be corrected using an approximation of the viscous forces, to improve the accuracy of the solution generated by an inviscid solver, while retaining the computation advantages of inviscid CFD\cite{Ward2018}. 

High fidelity methods consist of Navier-Stokes CFD solvers such as Eilmer3/4\cite{Gollan2013b}, Fluent\cite{Ansys2014}, CFX\cite{CFX}, COMSOL\cite{comsol}, TAU\cite{Schwamborn2006}, and OpenFOAM\cite{openfoam}. These solvers will resolve the fluid flow and aerodynamic forces to a high level of accuracy, including viscous effects. However, the mesh for the problem must be generated prior to the calculation of the solution, which increases the working time significantly. Additionally, the computation times are much longer, and require more computational resources than lower fidelity methods. These factors make the generation of an aerodynamic database using high fidelity CFD an extremely time consuming process, which is suited for use on mature vehicle designs, or when accurate flow simulation is absolutely necessary. 
This is the case for the simulation of the internal flow paths of scramjet engines, which contain complex flow fields featuring high Reynolds-number flow, complex shock wave structures, and large thermal and composition gradients that strongly impact performance\cite{Segal2009}. For this reason, scramjet engines must be simulated using high-fidelity methods to produce an accurate solution. 




\subsubsection{Cart3D}\label{sec:Cart3d}
\textcolor{red}{XXX Validate low mach no. paper and maybe discuss inviscid code at low mach numbers more (due to examiner comment)}
\textcolor{red}{XXX Abenayake paper shows that cart is relatively accurate at high mach no.s but not so accurate at low M and doesnt have right trends at transsonic. Abenayake also estimates errors}
\textcolor{red}{XXX line this section up with uncertainty section (also line missile datcom section up)}
Cart3D is an inviscid Euler solver CFD package, designed for use during preliminary vehicle design and analysis\cite{Almosnino2016}. Cart3D is computationally efficient and requires only a surface triangulation of the vehicle being analysed to initiate a simulation. Cart3D is utilised in this study due to its efficiency and ease of use, along with its demonstrated accuracy for hypersonic flow calculations\cite{Sagerman2017,Abeynayake,Aftosmis2011,Almosnino2016a}. Cart3D features adjoint mesh adaptation, and uses cartesian `cut-cells' which intersect the surface, allowing complex geometries to be analysed automatically. The mesh automatically refines as the simulation progresses, reducing error. The absence of a requirement for a user generated mesh allows Cart3D to be easily applied to complex launch vehicle designs, as well as allowing for simple modification of control surface deflections and flight conditions. 
Cart3D has been used extensively for aerodynamic simulations in preliminary design, including analysis of the plumes of the Skylon spaceplane\cite{Mehta2016}, HIFiRE-5\cite{Kimmel2010}, and in low sonic boom shape optimisations\cite{Aftosmis2011}. 
\begin{figure}[ht]
\centering
\includegraphics[width=0.6\linewidth]{figures/2_literature-review/Skylon-Cart3D}
\caption{The Skylon spaceplane, simulated using Cart3D at Mach 12.189, $\alpha=7.512^\circ$\cite{Mehta2016}. Cell distribution produced by mesh adaptation is shown.}
\label{fig:Skylon-Cart3D}
\end{figure}
Cart3D has shown good agreement when compared to experimental results for winged boosters at hypersonic speeds\cite{Sagerman2017}, as well as supersonic missiles\cite{Abeynayake} and aircraft\cite{Aftosmis2011}, and lifting bodies across wide Mach number ranges\cite{Almosnino2016a}.
In addition, good agreement has been shown between Cart3D, experimental results, and full Navier-Stokes solutions for the HIFIRE-1 hypersonic test payload\cite{Sagerman2017}. The model of the HIFIRE-1 and pressure coefficient results at each pressure tap are shown in Figure \ref{fig:Cart3DComparisons}. 
Good agreement is shown between Cart3D and experimental results at all nearly all tested locations, with the exception at an identified area of shock-induced boundary layer separation, which an inviscid solution does not capture\cite{Sagerman2017}. 
This indicates that Cart3D matches experimental results well in regions where the flow can be closely approximated by an inviscid analysis, however, regions of separation cause the accuracy of Cart3D to diverge significantly. 
Finally, in a comparison between Cart3D and the Overflow-D Navier-Stokes solver, it was shown that both codes produce similar pressure distributions for simulations of the space shuttle fuel tanks at low Mach numbers\cite{Gomez2004}. The Overflow-D simulations were stated to require at lease 20 times more CPU time than Cart3D\cite{Gomez2004}, an example of the efficiency afforded by Cart3D.
\begin{figure}[ht]
\centering
\includegraphics[width=0.9\linewidth]{"figures/2_literature-review/Cart3D Comparisons"}
\caption{Comparisons of Cart3D with experimental data and the FUN3D Navier-Stokes CFD solver. P1, P2 and P3 indicate pressure tap locations. Modified from Sagerman et al.\cite{Sagerman2017}. \textcolor{red}{XXX Change this picture to something more relevant}}
\label{fig:Cart3DComparisons}
\end{figure}


%\subsection{Missile Datcom}

%\textcolor{red}{XXX Rework this significantly, particularly where I say close agreement for pitching moment coeffs}


%Missile Datcom is a widely used, semi-empirical, aerodynamic prediction tool for missile configurations. Missile Datcom is used in this study for its extremely high computational efficiency and ease of use, along with its proven accuracy\cite{Sooy2005}. Missile Datcom uses component-buildup methods by which the aerodynamics of each component of a missile or rocket design are estimated and then added together to determine the aerodynamics of the entire vehicle. Missile Datcom uses a combination of empirical and theoretical methods and is capable of calculating the aerodynamic forces, stability derivatives, and moments over a range of angle of attack and Mach number values. The high efficiency of Missile Datcom allows an aerodynamic database to be generated simply and rapidly. Missile Datcom has been shown to produce close agreement with experimental wind tunnel data for normal force and pitching moment coefficients, and reasonable agreement for axial force coefficients\cite{Sooy2005}. 



      
      \section{Summary}
      \textcolor{red}{XXX Update summary}
This section provided a review of available literature, pertaining to the design and trajectory optimisation of a rocket-scramjet-rocket launch system.    
      The background of the operation of scramjet engines was outlined, along with a brief historical view. Some detail was then provided on current reusable launchers, and the small satellite launchers which are currently operational or in development. Previous work on airbreathing launchers was detailed, and the ascent trajectories of these launchers have been assessed. Prior works suggest that the optimal trajectory for an airbreathing-rocket vehicle operating as a single stage involves a pull-up from maximum dynamic pressure, before the vehicle transitions from airbreathing to rocket power. This pull-up is also observed in some multi-stage vehicle trajectories, performed in order to satisfy operational requirements, rather than specifically improving the performance of the launch system. The return trajectories of prior hypersonic launch systems have been investigated, and it was determined that a full glide-back of a vehicle is likely not possible without operation of the airbreathing engines. However, performing a `skipping' manoeuvre may assist in maximising the glide range. 
The rocket-scramjet-rocket launch system being developed at The University of Queensland was detailed, along with the propulsion model used, and previous trajectory simulations. A study of exoatmospheric rocket engines was conducted, and the SpaceX Kestrel engine was found to exhibit the best performance-per-kg compared to other pressure-fed engines. 
The background of optimal control theory was outlined, and the specific optimal control techniques which are most applicable to trajectory optimisation were detailed, along with a survey of existing optimal control solvers. 
A survey into CFD solvers was conducted, and the specifics of Cart3D and Missile Datcom, which are utilised in this study, were detailed. 